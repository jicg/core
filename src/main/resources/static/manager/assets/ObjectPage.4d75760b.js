var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,i)=>{for(var n in i||(i={}))a.call(i,n)&&o(e,n,i[n]);if(l)for(var n of l(i))t.call(i,n)&&o(e,n,i[n]);return e};import{D as n,C as r,g as d,B as s,h as p,_ as u,s as m,i as c,j as b,u as g,E as f,l as _,d as y,r as D,m as h,o as v,c as k,x as w,v as N,q as j,F as V,y as O,A as C,b as S,p as z,a as I,n as x,G as T,H as P,w as U,k as G,I as E}from"./index.b9440fcd.js";function Y(){const e=r();return{dialogRef:e,openDialog:(a,l,t,o)=>{if("string"==typeof l){const i=n((()=>u((()=>__import__(`${l}`)),void 0)));return e.value.openDialog(a,i,t,o)}return e.value.openDialog(a,l,t,o)},openObjectDialog:(a,l,t)=>{e.value.openObjectDialog(a,{tableName:l,id:t})}}}function q(e,a,l){if(e.js)window[e.js]&&window[e.js](a,l);else if(e.procName){const t=this.$loading({lock:!0,text:"执行【"+e.remark+"】...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});d.post(`/sys/manager/api/${e.table}/run/${e.name}`,[a.map((e=>e.id)).join(",")]).then((e=>{s("执行成功！"+e.data),t.close(),l&&l()})).catch((e=>{t.close(),p(e)}))}}n((()=>u((()=>__import__("./SearchPage.58bf6f87.js")),["./assets/SearchPage.58bf6f87.js","./assets/SearchPage.c3a206aa.css","./assets/index.b9440fcd.js","./assets/index.b6960b20.css","./assets/vendor.25d1acb5.js"])));var R=y({props:{tableInfo:{type:Object,default:{}},objectData:{type:Object,default:{}}},emits:["openDialog"],setup:(e,a)=>i({openDialog:(e,l,t)=>{a.emit("openDialog",e,l,t)}},function(e,a){g();let l=m({loading:!1,result:[],page:1,pageSize:30,orders:[],total:0,totalPage:0}),t=m({objectData:null,tableInfo:null});t.tableInfo=e.tableInfo,t.objectData=e.objectData;let o=e=>{if(null==t.objectData)return;let a={};a[t.tableInfo.upTableColumnName]=t.objectData.id,l.loading=!0,d.post("/sys/manager/api/"+t.tableInfo.name+"/list",{where:a,page:e,pageSize:l.pageSize,orders:l.orders}).then((e=>{l.result=e.data.datas,l.total=e.data.total,l.page=e.data.page,l.pageSize=e.data.pageSize,l.totalPage=e.data.totalPage,l.loading=!1})).catch((e=>{p(e),l.loading=!1}))};b(e,(()=>{o(1)}));let i=c((()=>t.tableInfo?t.tableInfo.columns.filter((e=>e.name!=t.tableInfo.upTableColumnName)):[]));return o(1),{handleSortChange:(e,a,t)=>{l.orders=e.prop?[{field:e.prop,order:"ascending"==e.order?"asc":"desc"}]:[],o(l.page)},dataGrid:l,data:t,queryData:o,listColumns:i}}(e)),name:"ItemGrid"});R.render=function(e,a,l,t,o,i){const n=D("el-pagination"),r=D("el-table-column"),d=D("el-option"),s=D("el-select"),p=D("el-icon"),u=D("el-table"),m=D("el-container"),c=h("loading");return v(),k(V,null,[w(n,{class:"border-none",onSizeChange:a[1]||(a[1]=a=>{e.dataGrid.pageSize=a,e.queryData(e.dataGrid.page)}),onCurrentChange:a[2]||(a[2]=a=>e.queryData(a)),currentPage:e.dataGrid.page,"onUpdate:currentPage":a[3]||(a[3]=a=>e.dataGrid.page=a),onPrevClick:a[4]||(a[4]=a=>e.queryData(e.dataGrid.page-1)),onNextClick:a[5]||(a[5]=a=>e.queryData(e.dataGrid.page+1)),"page-sizes":[10,30,50,100],"page-size":e.dataGrid.pageSize,layout:"sizes, prev, pager, next,total",total:e.dataGrid.total},null,8,["currentPage","page-size","total"]),w(m,null,{default:N((()=>[j(w(u,{class:"item-class",size:"mini",onSortChange:e.handleSortChange,data:e.dataGrid.result,height:420,border:""},{default:N((()=>[(v(!0),k(V,null,O(e.listColumns,(a=>(v(),k(V,null,["id"===a.apiName?(v(),k(r,{key:0,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,width:"60",prop:a.apiName,label:a.remark},null,8,["sortable","prop","label"])):"select"===a.view_type?(v(),k(r,{key:1,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark,width:"120"},{default:N((e=>[w(s,{size:"mini",disabled:"",modelValue:e.row[a.apiName],"onUpdate:modelValue":l=>e.row[a.apiName]=l,placeholder:"请选择"},{default:N((()=>[(v(!0),k(V,null,O(a.selectOps,(e=>(v(),k(d,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["min-width","sortable","prop","label"])):"object"===a.view_type?(v(),k(r,{key:2,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark},{default:N((l=>[w(p,{class:"el-icon-link",onClick:t=>e.openDialog(a.linkTableName,a.linkTable,l.row[a.apiName])},null,8,["onClick"]),w("span",null,C(l.row[a.apiName+"_desc"]),1)])),_:2},1032,["min-width","sortable","prop","label"])):(v(),k(r,{key:3,"min-width":30*a.list_size+40,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,prop:a.apiName,label:a.remark},{default:N((e=>[S(C(e.row[a.apiName]),1)])),_:2},1032,["min-width","sortable","prop","label"]))],64)))),256))])),_:1},8,["onSortChange","data"]),[[c,e.dataGrid.loading]])])),_:1})],64)};var M=y({props:{title:{type:String,default:"对话框"},is:{type:Object,default:y({name:"temp-dialog-default",render:()=>"<div>欢迎使用👏</div>"})},param:{type:Object,default:{}},events:{type:Object,default:{}}},setup(e,a){let l=r(!1),t=r(!1),o=r("对话框"),i=m({comp:e.is,param:e.param,events:{}});return{fullScreen:l,dialogVisible:t,openObjectDialog:(e,a)=>{i.param=a,i.comp=n((()=>u((()=>Promise.resolve().then((function(){return W}))),void 0))),t.value=!0},data:i,Title:o,openDialog:(e,a,l,n)=>(o.value=e,i.param=l,i.comp=a,i.events=n,t.value=!0,{close:()=>{t.value=!1}})}},name:"CustomDialog"});const A=U();z("data-v-61da3666");const L={style:{size:"12px","padding-left":"6px"}};I();const $=A(((e,a,l,t,o,i)=>{const n=D("el-icon"),r=D("el-col"),d=D("el-dialog");return v(),k(d,{"custom-class":e.fullScreen?"":"custom-el-dialog",width:"90%",fullscreen:e.fullScreen,"lock-scroll":"","append-to-body":"",modelValue:e.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogVisible=a),"destroy-on-close":""},{title:A((()=>[w(n,{class:"el-icon-reading"}),w("span",L,C(e.Title),1),w(r,{style:{width:"100%"}}),w("i",{onClick:a[1]||(a[1]=a=>e.fullScreen=!e.fullScreen),class:"el-dialog__headerbtn2 el-icon-full-screen"})])),default:A((()=>[(v(),k(x(e.data.comp),T(e.data.param,P(e.data.events)),null,16))])),_:1},8,["custom-class","fullscreen","modelValue"])}));M.render=$,M.__scopeId="data-v-61da3666";var H=y({components:{ItemGrid:R,CustomDialog:M},props:{id:{type:Number,default:-1},tableName:{type:String,default:""},editable:{type:Boolean,default:!1}},setup(e,a){let l=G();g();return i({openNewPage:e=>{window.open(l.resolve(e).href,"_blank")}},function(e,a){const l=g();let t=m({loading:!0,tableInfo:{},objectData:null}),o=m({value:null}),n=m({}),r=()=>{let a=e.tableName,o=l&&l.params.tableName;!a&&o&&(a=o),t.loading=!0,d.get("/sys/manager/api/table?name="+a).then((e=>{t.tableInfo=e.data,s()})).catch((e=>{p(e),t.loading=!1}))},s=()=>{let a=e.id,i=l&&l.params.id;-1==a&&i&&(a=i),d.get("/sys/manager/api/"+t.tableInfo.name+"/get?id="+a).then((e=>{t.objectData=e.data,o.value=t.tableInfo.itemTables,t.loading=!1})).catch((e=>{p(e),t.loading=!1}))};r();let u=c((()=>{var e,a;return null!=(a=null==(e=t.tableInfo.columns)?void 0:e.filter((e=>"id"!==e.name)))?a:[]}));b(t,(e=>{var a,l;null!=t.objectData&&(null!=(l=null==(a=t.tableInfo.columns)?void 0:a.filter((e=>"id"!==e.name)))?l:[]).forEach((e=>{"select"===e.view_type?n[e.apiName]=""+t.objectData[e.apiName]:"datenumber"===e.view_type?n[e.apiName]=f(""+t.objectData[e.apiName]):"object"===e.view_type?(n[e.apiName+"_desc"]=t.objectData[e.apiName+"_desc"],n[e.apiName]=t.objectData[e.apiName]):n[e.apiName]=t.objectData[e.apiName]}))}));let y=c((()=>_())),D=c((()=>o.value&&o.value.length>0?o.value:[]));return i(i({load:r,objectData:t,pageData:n,showColumns:u,selectLabel:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].remark:""},shortcuts:y},Y()),{itemTables:D})}(e))},name:"ObjectPage"});const B=U();z("data-v-7bb86555");const F=S("刷新"),J={style:{"margin-top":"36px"}},K={key:1,class:"el-form-item__content el-input el-input--mini is-disabled interpreter-column"};I();const Q=B(((e,a,l,t,o,i)=>{const n=D("el-button"),r=D("el-container"),d=D("el-input"),s=D("el-form-item"),p=D("el-date-picker"),u=D("el-option"),m=D("el-select"),c=D("el-col"),b=D("el-row"),g=D("el-form"),f=D("el-card"),_=D("item-grid"),y=D("el-tab-pane"),N=D("el-tabs"),S=D("custom-dialog"),z=h("loading");return v(),k(V,null,[j(w(r,{class:"affix-container",style:{padding:"10px","flex-direction":"column"}},{default:B((()=>[w(r,{class:"fixedContainer",style:{height:"30px","padding-bottom":"6px"}},{default:B((()=>[w(n,{type:"primary",onClick:a[1]||(a[1]=a=>e.load())},{default:B((()=>[F])),_:1})])),_:1}),w("div",J,[w(f,null,{default:B((()=>[w(g,{class:"custom-form","label-width":"80px",size:"mini"},{default:B((()=>[w(b,{gutter:20,style:{width:"100%"}},{default:B((()=>[(v(!0),k(V,null,O(e.showColumns,(a=>(v(),k(c,{xs:24*a.view_size,sm:12*a.view_size,md:6*a.view_size},{default:B((()=>["textarea"===a.view_type?(v(),k(s,{key:0,label:a.remark},{default:B((()=>[w(d,{class:"border-all",type:"textarea",autosize:"",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"date"===a.view_type?(v(),k(s,{key:1,label:a.remark},{default:B((()=>[w(p,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD HH:mm:ss",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"datenumber"===a.view_type?(v(),k(s,{key:2,label:a.remark},{default:B((()=>[w(p,{class:"border-all",disabled:!e.editable,style:{width:"100%"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"select"===a.view_type?(v(),k(s,{key:3,label:a.remark},{default:B((()=>[w(m,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,placeholder:"请选择"},{default:B((()=>[(v(!0),k(V,null,O(a.selectOps,(e=>(v(),k(u,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"object"===a.view_type?(v(),k(s,{key:4,"data-info":e.pageData.c_orig_id_desc,label:a.remark},{default:B((()=>[e.editable?(v(),k(d,{key:0,class:"border-all",modelValue:e.pageData[a.apiName+"_desc"],"onUpdate:modelValue":l=>e.pageData[a.apiName+"_desc"]=l},{suffix:B((()=>[w("i",{class:"el-input__icon el-icon-link",onClick:l=>e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},null,8,["onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue"])):(v(),k("div",K,[w("a",{class:"text_nowrap custom-column border-all custom-link el-link el-link--primary isReadonly",size:"mini",onClick:l=>e.pageData[a.apiName]&&e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},C(e.pageData[a.apiName]?e.pageData[a.apiName+"_desc"]:" "),9,["onClick"])]))])),_:2},1032,["data-info","label"])):(v(),k(s,{key:5,label:a.remark},{default:B((()=>[w(d,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"]))])),_:2},1032,["xs","sm","md"])))),256))])),_:1})])),_:1})])),_:1}),e.itemTables.length>0?(v(),k(N,{key:0,type:"border-card",style:{"margin-top":"10px"}},{default:B((()=>[(v(!0),k(V,null,O(e.itemTables,(a=>(v(),k(y,{label:a.remark},{default:B((()=>[w(_,{onOpenDialog:e.openObjectDialog,"table-info":a,"object-data":e.objectData.objectData},null,8,["onOpenDialog","table-info","object-data"])])),_:2},1032,["label"])))),256))])),_:1})):E("",!0)])])),_:1},512),[[z,e.objectData.loading]]),w(S,{ref:"dialogRef"},null,512)],64)}));H.render=Q,H.__scopeId="data-v-7bb86555";var W=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:H});export{W as O,M as _,H as a,q as e,Y as g};
