var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,i)=>{for(var n in i||(i={}))a.call(i,n)&&o(e,n,i[n]);if(l)for(var n of l(i))t.call(i,n)&&o(e,n,i[n]);return e};import{g as n,_ as d}from"./CustomDialog.668e4280.js";import{s as r,b as s,c as p,e as m,w as u,u as b,H as c,g,h as f,r as y,j as D,o as _,k as h,m as N,G as k,l as w,F as v,n as j,v as V,x as C,f as z,p as x,i as I,I as S,y as O}from"./index.5fcea91f.js";import"./vendor.25d1acb5.js";var U=f({props:{tableInfo:{type:Object,default:{}},objectData:{type:Object,default:{}}},emits:["openDialog"],setup:(e,a)=>i({openDialog:(e,l,t)=>{a.emit("openDialog",e,l,t)}},function(e,a){b();let l=r({loading:!1,result:[],page:1,pageSize:30,orders:[],total:0,totalPage:0}),t=r({objectData:null,tableInfo:null});t.tableInfo=e.tableInfo,t.objectData=e.objectData;let o=e=>{if(null==t.objectData)return;let a={};a[t.tableInfo.upTableColumnName]=t.objectData.id,l.loading=!0,s.post("/sys/manager/api/"+t.tableInfo.name+"/list",{where:a,page:e,pageSize:l.pageSize,orders:l.orders}).then((e=>{l.result=e.data.datas,l.total=e.data.total,l.page=e.data.page,l.pageSize=e.data.pageSize,l.totalPage=e.data.totalPage,l.loading=!1})).catch((e=>{p(e),l.loading=!1}))};u(e,(()=>{o(1)}));let i=m((()=>t.tableInfo?t.tableInfo.columns.filter((e=>e.name!=t.tableInfo.upTableColumnName)):[]));return o(1),{handleSortChange:(e,a,t)=>{l.orders=e.prop?[{field:e.prop,order:"ascending"==e.order?"asc":"desc"}]:[],o(l.page)},dataGrid:l,data:t,queryData:o,listColumns:i}}(e)),name:"ItemGrid"});U.render=function(e,a,l,t,o,i){const n=y("el-pagination"),d=y("el-table-column"),r=y("el-option"),s=y("el-select"),p=y("el-icon"),m=y("el-table"),u=y("el-container"),b=D("loading");return _(),h(v,null,[N(n,{class:"border-none",onSizeChange:a[1]||(a[1]=a=>{e.dataGrid.pageSize=a,e.queryData(e.dataGrid.page)}),onCurrentChange:a[2]||(a[2]=a=>e.queryData(a)),currentPage:e.dataGrid.page,"onUpdate:currentPage":a[3]||(a[3]=a=>e.dataGrid.page=a),onPrevClick:a[4]||(a[4]=a=>e.queryData(e.dataGrid.page-1)),onNextClick:a[5]||(a[5]=a=>e.queryData(e.dataGrid.page+1)),"page-sizes":[10,30,50,100],"page-size":e.dataGrid.pageSize,layout:"sizes, prev, pager, next,total",total:e.dataGrid.total},null,8,["currentPage","page-size","total"]),N(u,null,{default:k((()=>[w(N(m,{class:"item-class",size:"mini",onSortChange:e.handleSortChange,data:e.dataGrid.result,height:420,border:""},{default:k((()=>[(_(!0),h(v,null,j(e.listColumns,(a=>(_(),h(v,null,["id"===a.apiName?(_(),h(d,{key:0,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,width:"60",prop:a.apiName,label:a.remark},null,8,["sortable","prop","label"])):"select"===a.view_type?(_(),h(d,{key:1,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark,width:"120"},{default:k((e=>[N(s,{size:"mini",disabled:"",modelValue:e.row[a.apiName],"onUpdate:modelValue":l=>e.row[a.apiName]=l,placeholder:"请选择"},{default:k((()=>[(_(!0),h(v,null,j(a.selectOps,(e=>(_(),h(r,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["min-width","sortable","prop","label"])):"object"===a.view_type?(_(),h(d,{key:2,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark},{default:k((l=>[N(p,{class:"el-icon-link",onClick:t=>e.openDialog(a.linkTableName,a.linkTable,l.row[a.apiName])},null,8,["onClick"]),N("span",null,V(l.row[a.apiName+"_desc"]),1)])),_:2},1032,["min-width","sortable","prop","label"])):(_(),h(d,{key:3,"min-width":30*a.list_size+40,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,prop:a.apiName,label:a.remark},{default:k((e=>[C(V(e.row[a.apiName]),1)])),_:2},1032,["min-width","sortable","prop","label"]))],64)))),256))])),_:1},8,["onSortChange","data"]),[[b,e.dataGrid.loading]])])),_:1})],64)};var G=f({components:{ItemGrid:U,CustomDialog:d},props:{id:{type:Number,default:-1},tableName:{type:String,default:""},editable:{type:Boolean,default:!1}},setup(e,a){let l=z();b();return i({openNewPage:e=>{window.open(l.resolve(e).href,"_blank")}},function(e,a){const l=b();let t=r({loading:!0,tableInfo:{},objectData:null}),o=r({value:null}),d=r({}),f=()=>{let a=e.tableName,o=l&&l.params.tableName;!a&&o&&(a=o),t.loading=!0,s.get("/sys/manager/api/table?name="+a).then((e=>{t.tableInfo=e.data,y()})).catch((e=>{p(e),t.loading=!1}))},y=()=>{let a=e.id,i=l&&l.params.id;-1==a&&i&&(a=i),s.get("/sys/manager/api/"+t.tableInfo.name+"/get?id="+a).then((e=>{t.objectData=e.data,o.value=t.tableInfo.itemTables,t.loading=!1})).catch((e=>{p(e),t.loading=!1}))};f();let D=m((()=>{var e,a;return null!=(a=null==(e=t.tableInfo.columns)?void 0:e.filter((e=>"id"!==e.name)))?a:[]}));u(t,(e=>{var a,l;null!=t.objectData&&(null!=(l=null==(a=t.tableInfo.columns)?void 0:a.filter((e=>"id"!==e.name)))?l:[]).forEach((e=>{"select"===e.view_type?d[e.apiName]=""+t.objectData[e.apiName]:"datenumber"===e.view_type?d[e.apiName]=c(""+t.objectData[e.apiName]):"object"===e.view_type?(d[e.apiName+"_desc"]=t.objectData[e.apiName+"_desc"],d[e.apiName]=t.objectData[e.apiName]):d[e.apiName]=t.objectData[e.apiName]}))}));let _=m((()=>g())),h=m((()=>o.value&&o.value.length>0?o.value:[]));return i(i({load:f,objectData:t,pageData:d,showColumns:D,selectLabel:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].remark:""},shortcuts:_},n()),{itemTables:h})}(e))},name:"ObjectPage"});const P=O();x("data-v-7bb86555");const T=C("刷新"),Y={style:{"margin-top":"36px"}},q={key:1,class:"el-form-item__content el-input el-input--mini is-disabled interpreter-column"};I();const M=P(((e,a,l,t,o,i)=>{const n=y("el-button"),d=y("el-container"),r=y("el-input"),s=y("el-form-item"),p=y("el-date-picker"),m=y("el-option"),u=y("el-select"),b=y("el-col"),c=y("el-row"),g=y("el-form"),f=y("el-card"),k=y("item-grid"),C=y("el-tab-pane"),z=y("el-tabs"),x=y("custom-dialog"),I=D("loading");return _(),h(v,null,[w(N(d,{class:"affix-container",style:{padding:"10px","flex-direction":"column"}},{default:P((()=>[N(d,{class:"fixedContainer",style:{height:"30px","padding-bottom":"6px"}},{default:P((()=>[N(n,{type:"primary",onClick:a[1]||(a[1]=a=>e.load())},{default:P((()=>[T])),_:1})])),_:1}),N("div",Y,[N(f,null,{default:P((()=>[N(g,{class:"custom-form","label-width":"80px",size:"mini"},{default:P((()=>[N(c,{gutter:20,style:{width:"100%"}},{default:P((()=>[(_(!0),h(v,null,j(e.showColumns,(a=>(_(),h(b,{xs:24*a.view_size,sm:12*a.view_size,md:6*a.view_size},{default:P((()=>["textarea"===a.view_type?(_(),h(s,{key:0,label:a.remark},{default:P((()=>[N(r,{class:"border-all",type:"textarea",autosize:"",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"date"===a.view_type?(_(),h(s,{key:1,label:a.remark},{default:P((()=>[N(p,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD HH:mm:ss",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"datenumber"===a.view_type?(_(),h(s,{key:2,label:a.remark},{default:P((()=>[N(p,{class:"border-all",disabled:!e.editable,style:{width:"100%"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"select"===a.view_type?(_(),h(s,{key:3,label:a.remark},{default:P((()=>[N(u,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,placeholder:"请选择"},{default:P((()=>[(_(!0),h(v,null,j(a.selectOps,(e=>(_(),h(m,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"object"===a.view_type?(_(),h(s,{key:4,"data-info":e.pageData.c_orig_id_desc,label:a.remark},{default:P((()=>[e.editable?(_(),h(r,{key:0,class:"border-all",modelValue:e.pageData[a.apiName+"_desc"],"onUpdate:modelValue":l=>e.pageData[a.apiName+"_desc"]=l},{suffix:P((()=>[N("i",{class:"el-input__icon el-icon-link",onClick:l=>e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},null,8,["onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue"])):(_(),h("div",q,[N("a",{class:"text_nowrap custom-column border-all custom-link el-link el-link--primary isReadonly",size:"mini",onClick:l=>e.pageData[a.apiName]&&e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},V(e.pageData[a.apiName]?e.pageData[a.apiName+"_desc"]:" "),9,["onClick"])]))])),_:2},1032,["data-info","label"])):(_(),h(s,{key:5,label:a.remark},{default:P((()=>[N(r,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"]))])),_:2},1032,["xs","sm","md"])))),256))])),_:1})])),_:1})])),_:1}),e.itemTables.length>0?(_(),h(z,{key:0,type:"border-card",style:{"margin-top":"10px"}},{default:P((()=>[(_(!0),h(v,null,j(e.itemTables,(a=>(_(),h(C,{label:a.remark},{default:P((()=>[N(k,{onOpenDialog:e.openObjectDialog,"table-info":a,"object-data":e.objectData.objectData},null,8,["onOpenDialog","table-info","object-data"])])),_:2},1032,["label"])))),256))])),_:1})):S("",!0)])])),_:1},512),[[I,e.objectData.loading]]),N(x,{ref:"dialogRef"},null,512)],64)}));G.render=M,G.__scopeId="data-v-7bb86555";export default G;
