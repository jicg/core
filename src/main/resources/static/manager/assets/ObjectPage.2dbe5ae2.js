var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,i)=>{for(var n in i||(i={}))a.call(i,n)&&o(e,n,i[n]);if(l)for(var n of l(i))t.call(i,n)&&o(e,n,i[n]);return e};import{s as n,c as d,e as r,B as p,f as s,g as u,r as m,u as b,C as c,i as g,d as f,k as y,l as h,o as D,m as _,t as N,D as k,q as w,F as v,v as j,z as V,y as C,h as I,p as x,j as z,E as S,w as U}from"./index.a11cd22e.js";import"./vendor.25d1acb5.js";var O=f({props:{tableInfo:{type:Object,default:{}},objectData:{type:Object,default:{}}},emits:["openDialog"],setup:(e,a)=>i({openDialog:(e,l,t)=>{a.emit("openDialog",e,l,t)}},function(e,a){b();let l=n({loading:!1,result:[],page:1,pageSize:30,orders:[],total:0,totalPage:0}),t=n({objectData:null,tableInfo:null});t.tableInfo=e.tableInfo,t.objectData=e.objectData;let o=e=>{if(null==t.objectData)return;let a={};a[t.tableInfo.upTableColumnName]=t.objectData.id,l.loading=!0,d.post("/sys/manager/api/"+t.tableInfo.name+"/list",{where:a,page:e,pageSize:l.pageSize,orders:l.orders}).then((e=>{l.result=e.data.datas,l.total=e.data.total,l.page=e.data.page,l.pageSize=e.data.pageSize,l.totalPage=e.data.totalPage,l.loading=!1})).catch((e=>{r(e),l.loading=!1}))};u(e,(()=>{o(1)}));let i=s((()=>t.tableInfo?t.tableInfo.columns.filter((e=>e.name!=t.tableInfo.upTableColumnName)):[]));return o(1),{handleSortChange:(e,a,t)=>{l.orders=e.prop?[{field:e.prop,order:"ascending"==e.order?"asc":"desc"}]:[],o(l.page)},dataGrid:l,data:t,queryData:o,listColumns:i}}(e)),name:"ItemGrid"});O.render=function(e,a,l,t,o,i){const n=y("el-pagination"),d=y("el-table-column"),r=y("el-option"),p=y("el-select"),s=y("el-icon"),u=y("el-table"),m=y("el-container"),b=h("loading");return D(),_(v,null,[N(n,{onSizeChange:a[1]||(a[1]=a=>{e.dataGrid.pageSize=a,e.queryData(e.dataGrid.page)}),onCurrentChange:a[2]||(a[2]=a=>e.queryData(a)),currentPage:e.dataGrid.page,"onUpdate:currentPage":a[3]||(a[3]=a=>e.dataGrid.page=a),onPrevClick:a[4]||(a[4]=a=>e.queryData(e.dataGrid.page-1)),onNextClick:a[5]||(a[5]=a=>e.queryData(e.dataGrid.page+1)),"page-sizes":[10,30,50,100],"page-size":e.dataGrid.pageSize,layout:"sizes, prev, pager, next,total",total:e.dataGrid.total},null,8,["currentPage","page-size","total"]),N(m,null,{default:k((()=>[w(N(u,{size:"mini",onSortChange:e.handleSortChange,data:e.dataGrid.result,height:480,border:""},{default:k((()=>[(D(!0),_(v,null,j(e.listColumns,(a=>(D(),_(v,null,["id"===a.apiName?(D(),_(d,{key:0,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,width:"60",prop:a.apiName,label:a.remark},null,8,["sortable","prop","label"])):"select"===a.view_type?(D(),_(d,{key:1,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark,width:"120"},{default:k((e=>[N(p,{size:"mini",disabled:"",modelValue:e.row[a.apiName],"onUpdate:modelValue":l=>e.row[a.apiName]=l,placeholder:"请选择"},{default:k((()=>[(D(!0),_(v,null,j(a.selectOps,(e=>(D(),_(r,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["sortable","prop","label"])):"object"===a.view_type?(D(),_(d,{key:2,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark},{default:k((l=>[N(s,{class:"el-icon-link",onClick:t=>e.openDialog(a.linkTableName,a.linkTable,l.row[a.apiName])},null,8,["onClick"]),N("span",null,V(l.row[a.apiName+"_desc"]),1)])),_:2},1032,["sortable","prop","label"])):(D(),_(d,{key:3,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,prop:a.apiName,label:a.remark},{default:k((e=>[C(V(e.row[a.apiName]),1)])),_:2},1032,["sortable","prop","label"]))],64)))),256))])),_:1},8,["onSortChange","data"]),[[b,e.dataGrid.loading]])])),_:1})],64)};var G=f({components:{ItemGrid:O},props:{id:{type:Number,default:-1},tableName:{type:String,default:""},editable:{type:Boolean,default:!1}},setup(e,a){let l=m(!1),t=I(),o=b();console.log(o.path);return i({fullScreen:l,openNewPage:e=>{window.open(t.resolve(e).href,"_blank")}},function(e,a){const l=b();let t=n({loading:!0,tableInfo:{},objectData:null}),o=n({value:null}),i=n({}),f=()=>{let a=e.tableName,o=l.params.tableName;!a&&o&&(a=o),t.loading=!0,d.get("/sys/manager/api/table?name="+a).then((e=>{t.tableInfo=e.data,y()})).catch((e=>{r(e),t.loading=!1}))},y=()=>{let a=e.id,i=l.params.id;-1==a&&i&&(a=i),d.get("/sys/manager/api/"+t.tableInfo.name+"/get?id="+a).then((e=>{t.objectData=e.data,o.value=t.tableInfo.itemTables,t.loading=!1,p(t.tableInfo.name)})).catch((e=>{r(e),t.loading=!1}))};f();let h=s((()=>{var e,a;return null!=(a=null==(e=t.tableInfo.columns)?void 0:e.filter((e=>"id"!==e.name)))?a:[]}));u(t,(e=>{var a,l;null!=t.objectData&&(null!=(l=null==(a=t.tableInfo.columns)?void 0:a.filter((e=>"id"!==e.name)))?l:[]).forEach((e=>{"select"===e.view_type?i[e.apiName]=""+t.objectData[e.apiName]:"datenumber"===e.view_type?i[e.apiName]=c(""+t.objectData[e.apiName]):"object"===e.view_type?(i[e.apiName+"_desc"]=t.objectData[e.apiName+"_desc"],i[e.apiName]=t.objectData[e.apiName]):i[e.apiName]=t.objectData[e.apiName]}))}));let D=m(!1),_=n({tableName:"",id:-1,title:""}),N=s((()=>g())),k=s((()=>o.value&&o.value.length>0?o.value:[]));return{load:f,objectData:t,pageData:i,showColumns:h,selectLabel:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].remark:""},shortcuts:N,openDialog:(e,a,l)=>{_.title=e,_.tableName=a,_.id=l,D.value=!0},openId:_,dialogVisible:D,itemTables:k}}(e))},name:"ObjectPage"});const P=U();x("data-v-a7f00e3e");const T=C("刷新"),Y=C(" 查看 "),q={style:{"margin-top":"36px"}},M={style:{size:"12px","padding-left":"6px"}};z();const E=P(((e,a,l,t,o,i)=>{const n=y("el-button"),d=y("el-container"),r=y("el-input"),p=y("el-form-item"),s=y("el-date-picker"),u=y("el-option"),m=y("el-select"),b=y("el-col"),c=y("el-row"),g=y("el-form"),f=y("el-card"),k=y("el-divider"),C=y("item-grid"),I=y("el-tab-pane"),x=y("el-tabs"),z=y("el-icon"),U=y("object-page",!0),O=y("el-dialog"),G=h("loading");return D(),_(v,null,[w(N(d,{class:"affix-container",style:{padding:"10px","flex-direction":"column"}},{default:P((()=>[N(d,{class:"fixedContainer",style:{height:"30px","padding-bottom":"6px"}},{default:P((()=>[N(n,{type:"primary",onClick:a[1]||(a[1]=a=>e.load())},{default:P((()=>[T])),_:1}),e.$route.path.startsWith("/object/")?S("",!0):(D(),_(n,{key:0,type:"primary",onClick:a[2]||(a[2]=a=>e.openNewPage(`/object/${e.objectData.tableInfo.name}/${e.objectData.objectData.id}`))},{default:P((()=>[Y])),_:1}))])),_:1}),N("div",q,[N(f,null,{default:P((()=>[N(g,{"label-width":"100px",size:"mini"},{default:P((()=>[N(c,{gutter:20,style:{width:"100%"}},{default:P((()=>[(D(!0),_(v,null,j(e.showColumns,(a=>(D(),_(b,{xs:24*a.view_size,sm:12*a.view_size,md:8*a.view_size,lg:6*a.view_size},{default:P((()=>["textarea"===a.view_type?(D(),_(p,{key:0,label:a.remark},{default:P((()=>[N(r,{type:"textarea",autosize:"",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"date"===a.view_type?(D(),_(p,{key:1,label:a.remark},{default:P((()=>[N(s,{disabled:!e.editable,style:{width:"auto!important"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD HH:mm:ss",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"datenumber"===a.view_type?(D(),_(p,{key:2,label:a.remark},{default:P((()=>[N(s,{disabled:!e.editable,style:{width:"auto!important"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"select"===a.view_type?(D(),_(p,{key:3,label:a.remark},{default:P((()=>[N(m,{disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,placeholder:"请选择"},{default:P((()=>[(D(!0),_(v,null,j(a.selectOps,(e=>(D(),_(u,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"object"===a.view_type?(D(),_(p,{key:4,"data-info":e.pageData.c_orig_id_desc,label:a.remark},{default:P((()=>[e.editable?(D(),_(r,{key:0,modelValue:e.pageData[a.apiName+"_desc"],"onUpdate:modelValue":l=>e.pageData[a.apiName+"_desc"]=l},{suffix:P((()=>[N("i",{class:"el-input__icon el-icon-link",onClick:l=>e.openDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},null,8,["onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue"])):(D(),_("i",{key:1,class:"text_nowrap",style:{width:"100%",transform:"translateY(-2.1px)",height:"28px",background:"white",border:"none","text-align":"left","font-size":"12px",color:"#C0C4CC"},size:"mini",onClick:l=>e.openDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},V(e.pageData[a.apiName+"_desc"]),9,["onClick"]))])),_:2},1032,["data-info","label"])):(D(),_(p,{key:5,label:a.remark},{default:P((()=>[N(r,{disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"]))])),_:2},1032,["xs","sm","md","lg"])))),256))])),_:1})])),_:1})])),_:1}),e.itemTables.length>0?(D(),_(k,{key:0})):S("",!0),e.itemTables.length>0?(D(),_(x,{key:1,type:"border-card"},{default:P((()=>[(D(!0),_(v,null,j(e.itemTables,(a=>(D(),_(I,{label:a.remark},{default:P((()=>[N(C,{onOpenDialog:e.openDialog,"table-info":a,"object-data":e.objectData.objectData},null,8,["onOpenDialog","table-info","object-data"])])),_:2},1032,["label"])))),256))])),_:1})):S("",!0)])])),_:1},512),[[G,e.objectData.loading]]),N(O,{"custom-class":e.fullScreen?"":"custom-el-dialog",width:"90%",fullscreen:e.fullScreen,"lock-scroll":"","append-to-body":"",modelValue:e.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=a=>e.dialogVisible=a),"destroy-on-close":""},{title:P((()=>[N(z,{class:"el-icon-reading"}),N("span",M,V(e.openId.title),1),N(b,{style:{width:"100%"}}),N("i",{onClick:a[3]||(a[3]=a=>e.fullScreen=!e.fullScreen),class:"el-dialog__headerbtn2 el-icon-full-screen"})])),default:P((()=>[N(U,{"table-name":e.openId.tableName,id:e.openId.id},null,8,["table-name","id"])])),_:1},8,["custom-class","fullscreen","modelValue"])],64)}));G.render=E,G.__scopeId="data-v-a7f00e3e";export default G;
