var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&n(e,l,a[l]);return e};"undefined"!=typeof require&&require;import{g as d,_ as s}from"./CustomDialog.5ebe0272.js";import{s as p,b as m,v as u,x as b,u as c,e as g,r as f,f as y,i as D,h,g as _,F as N,o as w,w as k,j as v,c as j,k as V,t as C,l as z,a as x,A as O,B as I,K as S}from"./vendor.70422edf.js";import{s as U,b as P,e as G}from"./index.f1b42049.js";function T(e,t){const o=c();let i=p({loading:!0,tableInfo:{},objectData:null}),n=p({value:null}),s=p({}),g=()=>{let a=e.tableName,l=o&&o.params.tableName;!a&&l&&(a=l),i.loading=!0,m.get("/sys/manager/api/table?name="+a).then((e=>{i.tableInfo=e.data,f()})).catch((e=>{U(e),i.loading=!1}))},f=()=>{let a=e.id,l=o&&o.params.id;-1==a&&l&&(a=l),m.get("/sys/manager/api/"+i.tableInfo.name+"/get?id="+a).then((e=>{i.objectData=e.data,n.value=i.tableInfo.itemTables,i.loading=!1})).catch((e=>{U(e),i.loading=!1}))};g();let y=u((()=>{var e,a;return null!=(a=null==(e=i.tableInfo.columns)?void 0:e.filter((e=>"id"!==e.name)))?a:[]}));b(i,(e=>{var a,l;if(null==i.objectData)return;(null!=(l=null==(a=i.tableInfo.columns)?void 0:a.filter((e=>"id"!==e.name)))?l:[]).forEach((e=>{"select"===e.view_type?s[e.apiName]=""+i.objectData[e.apiName]:"datenumber"===e.view_type?s[e.apiName]=G(""+i.objectData[e.apiName]):"object"===e.view_type?(s[e.apiName+"_desc"]=i.objectData[e.apiName+"_desc"],s[e.apiName]=i.objectData[e.apiName]):s[e.apiName]=i.objectData[e.apiName]}))}));let D=u((()=>P())),h=u((()=>n.value&&n.value.length>0?n.value:[]));return _=r({load:g,objectData:i,pageData:s,showColumns:y,selectLabel:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].remark:""},shortcuts:D},d()),a(_,l({itemTables:h}));var _}var Y=g({props:{tableInfo:{type:Object,default:{}},objectData:{type:Object,default:{}}},emits:["openDialog"],setup:(e,a)=>r({openDialog:(e,l,t)=>{a.emit("openDialog",e,l,t)}},function(e,a){c();let l=p({loading:!1,result:[],page:1,pageSize:30,orders:[],total:0,totalPage:0}),t=p({objectData:null,tableInfo:null});t.tableInfo=e.tableInfo,t.objectData=e.objectData;let o=e=>{if(null==t.objectData)return;let a={};a[t.tableInfo.upTableColumnName]="= "+t.objectData.id,l.loading=!0,m.post("/sys/manager/api/"+t.tableInfo.name+"/list",{where:a,page:e,pageSize:l.pageSize,orders:l.orders}).then((e=>{l.result=e.data.datas,l.total=e.data.total,l.page=e.data.page,l.pageSize=e.data.pageSize,l.totalPage=e.data.totalPage,l.loading=!1})).catch((e=>{U(e),l.loading=!1}))};b(e,(()=>{o(1)}));let i=u((()=>t.tableInfo?t.tableInfo.columns.filter((e=>e.name!=t.tableInfo.upTableColumnName)):[]));return o(1),{handleSortChange:(e,a,t)=>{l.orders=e.prop?[{field:e.prop,order:"ascending"==e.order?"asc":"desc"}]:[],o(l.page)},dataGrid:l,data:t,queryData:o,listColumns:i}}(e)),name:"ItemGrid"});Y.render=function(e,a,l,t,o,i){const n=f("el-pagination"),r=f("el-table-column"),d=f("el-option"),s=f("el-select"),p=f("el-icon"),m=f("el-table"),u=f("el-container"),b=y("loading");return w(),D(N,null,[h(n,{class:"border-none",onSizeChange:a[0]||(a[0]=a=>{e.dataGrid.pageSize=a,e.queryData(e.dataGrid.page)}),onCurrentChange:a[1]||(a[1]=a=>e.queryData(a)),currentPage:e.dataGrid.page,"onUpdate:currentPage":a[2]||(a[2]=a=>e.dataGrid.page=a),onPrevClick:a[3]||(a[3]=a=>e.queryData(e.dataGrid.page-1)),onNextClick:a[4]||(a[4]=a=>e.queryData(e.dataGrid.page+1)),"page-sizes":[10,30,50,100],"page-size":e.dataGrid.pageSize,layout:"sizes, prev, pager, next,total",total:e.dataGrid.total},null,8,["currentPage","page-size","total"]),h(u,null,{default:_((()=>[k(h(m,{class:"item-class",size:"mini",onSortChange:e.handleSortChange,data:e.dataGrid.result,height:420,border:""},{default:_((()=>[(w(!0),D(N,null,v(e.listColumns,(a=>(w(),D(N,null,["id"===a.apiName?(w(),j(r,{key:0,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,width:"60",prop:a.apiName,label:a.remark},null,8,["sortable","prop","label"])):"select"===a.view_type?(w(),j(r,{key:1,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark,width:"120"},{default:_((e=>[h(s,{size:"mini",disabled:"",modelValue:e.row[a.apiName],"onUpdate:modelValue":l=>e.row[a.apiName]=l,placeholder:"请选择"},{default:_((()=>[(w(!0),D(N,null,v(a.selectOps,(e=>(w(),j(d,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["min-width","sortable","prop","label"])):"object"===a.view_type?(w(),j(r,{key:2,"min-width":30*a.list_size+40,"show-overflow-tooltip":!0,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark},{default:_((l=>[h(p,{class:"el-icon-link",onClick:t=>e.openDialog(a.linkTableName,a.linkTable,l.row[a.apiName])},null,8,["onClick"]),V("span",null,C(l.row[a.apiName+"_desc"]),1)])),_:2},1032,["min-width","sortable","prop","label"])):(w(),j(r,{key:3,"min-width":30*a.list_size+40,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,prop:a.apiName,label:a.remark},{default:_((e=>[z(C(e.row[a.apiName]),1)])),_:2},1032,["min-width","sortable","prop","label"]))],64)))),256))])),_:1},8,["onSortChange","data"]),[[b,e.dataGrid.loading]])])),_:1})],64)};var q=g({components:{ItemGrid:Y,CustomDialog:s},props:{id:{type:Number,default:-1},tableName:{type:String,default:""},editable:{type:Boolean,default:!1}},setup(e,a){let l=x();c();return r({openNewPage:e=>{window.open(l.resolve(e).href,"_blank")}},T(e))},name:"ObjectPage"});O("data-v-d0538f52");const M=z("刷新"),B={style:{"margin-top":"36px"}},E=["onClick"],H={key:1,class:"el-form-item__content el-input el-input--mini is-disabled interpreter-column"},R=["onClick"];I(),q.render=function(e,a,l,t,o,i){const n=f("el-button"),r=f("el-container"),d=f("el-input"),s=f("el-form-item"),p=f("el-date-picker"),m=f("el-option"),u=f("el-select"),b=f("el-col"),c=f("el-row"),g=f("el-form"),z=f("el-card"),x=f("item-grid"),O=f("el-tab-pane"),I=f("el-tabs"),U=f("custom-dialog"),P=y("loading");return w(),D(N,null,[k(h(r,{class:"affix-container",style:{padding:"10px","flex-direction":"column"}},{default:_((()=>[h(r,{class:"fixedContainer",style:{height:"30px","padding-bottom":"6px"}},{default:_((()=>[h(n,{type:"primary",onClick:a[0]||(a[0]=a=>e.load())},{default:_((()=>[M])),_:1})])),_:1}),V("div",B,[h(z,null,{default:_((()=>[h(g,{class:"custom-form","label-width":"80px",size:"mini"},{default:_((()=>[h(c,{gutter:0,style:{width:"100%"}},{default:_((()=>[(w(!0),D(N,null,v(e.showColumns,(a=>(w(),j(b,{xs:24*a.view_size,sm:12*a.view_size,md:6*a.view_size},{default:_((()=>["textarea"===a.view_type?(w(),j(s,{key:0,label:a.remark},{default:_((()=>[h(d,{class:"border-all",type:"textarea",autosize:"",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"date"===a.view_type?(w(),j(s,{key:1,label:a.remark},{default:_((()=>[h(p,{class:"border-all",disabled:!e.editable,style:{width:"100%"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD HH:mm:ss",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"datenumber"===a.view_type?(w(),j(s,{key:2,label:a.remark},{default:_((()=>[h(p,{class:"border-all",disabled:!e.editable,style:{width:"100%"},modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,type:"date",placeholder:"选择日期",format:"YYYYMMDD",shortcuts:e.shortcuts},null,8,["disabled","modelValue","onUpdate:modelValue","shortcuts"])])),_:2},1032,["label"])):"select"===a.view_type?(w(),j(s,{key:3,label:a.remark},{default:_((()=>[h(u,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l,placeholder:"请选择"},{default:_((()=>[(w(!0),D(N,null,v(a.selectOps,(e=>(w(),j(m,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])):"object"===a.view_type?(w(),j(s,{key:4,"data-info":e.pageData[a.apiName+"_desc"],label:a.remark},{default:_((()=>[e.editable?(w(),j(d,{key:0,class:"border-all",modelValue:e.pageData[a.apiName+"_desc"],"onUpdate:modelValue":l=>e.pageData[a.apiName+"_desc"]=l},{suffix:_((()=>[V("i",{class:"el-input__icon el-icon-link",onClick:l=>e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},null,8,E)])),_:2},1032,["modelValue","onUpdate:modelValue"])):(w(),D("div",H,[V("a",{class:"text_nowrap custom-column border-all custom-link el-link el-link--primary isReadonly",size:"mini",onClick:l=>e.pageData[a.apiName]&&e.openObjectDialog(a.linkTableName,a.linkTable,e.pageData[a.apiName])},C(e.pageData[a.apiName]?e.pageData[a.apiName+"_desc"]:" "),9,R)]))])),_:2},1032,["data-info","label"])):(w(),j(s,{key:5,label:a.remark},{default:_((()=>[h(d,{class:"border-all",disabled:!e.editable,modelValue:e.pageData[a.apiName],"onUpdate:modelValue":l=>e.pageData[a.apiName]=l},null,8,["disabled","modelValue","onUpdate:modelValue"])])),_:2},1032,["label"]))])),_:2},1032,["xs","sm","md"])))),256))])),_:1})])),_:1})])),_:1}),e.itemTables.length>0?(w(),j(I,{key:0,type:"border-card",style:{"margin-top":"10px"}},{default:_((()=>[(w(!0),D(N,null,v(e.itemTables,(a=>(w(),j(O,{label:a.remark},{default:_((()=>[h(x,{onOpenDialog:e.openObjectDialog,"table-info":a,"object-data":e.objectData.objectData},null,8,["onOpenDialog","table-info","object-data"])])),_:2},1032,["label"])))),256))])),_:1})):S("",!0)])])),_:1},512),[[P,e.objectData.loading]]),h(U,{ref:"dialogRef"},null,512)],64)},q.__scopeId="data-v-d0538f52";export default q;
