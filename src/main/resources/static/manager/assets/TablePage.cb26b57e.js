var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{r,s as n,a as i,b as d,c as s,e as p,f as u,g as m,u as c,h as b,i as g,d as f,p as y,j as h,k,l as N,o as w,m as D,n as v,q as S,t as _,F as I,v as P,x as C,y as V,z as q,w as z}from"./index.a11cd22e.js";import x from"./JobPage.99038c83.js";import j from"./ObjectPage.2dbe5ae2.js";import"./vendor.25d1acb5.js";var O=f({props:{},setup:(e,f)=>((e,r)=>{for(var n in r||(r={}))a.call(r,n)&&o(e,n,r[n]);if(l)for(var n of l(r))t.call(r,n)&&o(e,n,r[n]);return e})({fullScreen:r(!1)},function(){let e=r(!1),a=n({}),l=n({tableName:"",id:-1,title:""}),t=n({loading:!1,tableInfo:{}}),o=n({loading:!1,result:[],page:1,pageSize:30,orders:[],total:0,totalPage:0}),f=e=>{let l={};t.tableInfo.columns.forEach((e=>{let t=a[e.apiName];t&&("datenumber"==e.view_type?t.length>0&&(l[e.apiName]="BETWEEN "+i(t[0])+" AND "+i(t[1])):"date"==e.view_type?t.length>0&&(l[e.apiName]=[d(t[0]),d(t[1])]):l[e.apiName]=a[e.apiName])})),o.loading=!0,s.post("/sys/manager/api/"+t.tableInfo.name+"/list",{where:l,page:e,pageSize:o.pageSize,orders:o.orders}).then((e=>{o.result=e.data.datas,o.total=e.data.total,o.page=e.data.page,o.pageSize=e.data.pageSize,o.totalPage=e.data.totalPage,o.loading=!1})).catch((e=>{p(e),o.loading=!1}))};(()=>{const e=c();t.loading=!0,s.get("/sys/manager/api/table?name="+e.params.tableName).then((e=>{t.tableInfo=e.data,t.loading=!1,t.tableInfo.url||f(1)})).catch((e=>{p(e),t.loading=!1}))})();let y=u((()=>{var e,a;return null==(a=null==(e=t.tableInfo)?void 0:e.columns)?void 0:a.filter((e=>"Y"===e.isQuery))}));b();let h=u((()=>g()));return m(t,(e=>{e.tableInfo.columns.forEach((e=>{a[e.apiName]=""}))})),{tableData:t,shortcuts:h,queryParam:a,queryCols:y,queryData:f,selectLabel:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].remark:""},selectColor:(e,a)=>{let l=a.selectOps.filter((a=>a.name==e));return l.length>0?l[0].color:""},dataGrid:o,handleSortChange:(e,a,l)=>{o.orders=e.prop?[{field:e.prop,order:"ascending"==e.order?"asc":"desc"}]:[],f(o.page)},handleSelectionChange:e=>{console.log(e)},handleRowDbClick:(a,o,r)=>{l.title=t.tableInfo.remark,l.tableName=t.tableInfo.name,l.id=a.id,e.value=!0},dialogVisible:e,openId:l,openDialog:(a,t,o)=>{l.title=a,l.tableName=t,l.id=o,e.value=!0}}}()),name:"TablePage",components:{JobPage:x,ObjectPage:j}});const G=z();y("data-v-5aa855f0");const U=V("查询"),Y={style:{size:"12px","padding-left":"6px"}};h();const E=G(((e,a,l,t,o,r)=>{const n=k("el-option"),i=k("el-select"),d=k("el-date-picker"),s=k("el-input"),p=k("el-form-item"),u=k("el-button"),m=k("el-form"),c=k("el-card"),b=k("el-table-column"),g=k("el-tag"),f=k("el-icon"),y=k("el-table"),h=k("el-container"),z=k("el-pagination"),x=k("el-col"),j=k("object-page"),O=k("el-dialog"),E=N("loading");return w(),D(I,null,[null!=e.tableData.tableInfo.name&&null!=e.tableData.tableInfo.url&&e.tableData.tableInfo.url.length>0&&e.tableData.tableInfo.url.indexOf("/")>=0?(w(),D("iframe",{key:0,style:{width:"100%",height:"calc(100% - 10px)",border:"none"},src:e.tableData.tableInfo.url},null,8,["src"])):null!=e.tableData.tableInfo.name&&null!=e.tableData.tableInfo.url&&e.tableData.tableInfo.url.length>0?(w(),D(v(e.tableData.tableInfo.url),{key:1})):S((w(),D(h,{key:2,style:{"flex-direction":"column"},"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"},{default:G((()=>[_(c,{shadow:"always",style:{margin:"10px"}},{default:G((()=>[_(m,{size:"small",inline:!0,class:"demo-form-inline","label-width":"80px;"},{default:G((()=>[(w(!0),D(I,null,P(e.queryCols,(l=>(w(),D(p,{label:l.remark},{default:G((()=>["select"===l.view_type?(w(),D(i,{key:0,modelValue:e.queryParam[l.apiName],"onUpdate:modelValue":a=>e.queryParam[l.apiName]=a,placeholder:"请选择"},{default:G((()=>[_(n,{label:"全部",value:""}),(w(!0),D(I,null,P(l.selectOps,(e=>(w(),D(n,{label:e.remark,value:e.name},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])):"date"===l.view_type?(w(),D(d,{key:1,modelValue:e.queryParam[l.apiName],"onUpdate:modelValue":a=>e.queryParam[l.apiName]=a,type:"datetimerange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:e.shortcuts,format:"YYYYMMDD HH:mm:ss"},null,8,["modelValue","onUpdate:modelValue","shortcuts"])):"datenumber"===l.view_type?(w(),D(d,{key:2,modelValue:e.queryParam[l.apiName],"onUpdate:modelValue":a=>e.queryParam[l.apiName]=a,type:"daterange",format:"YYYYMMDD","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:e.shortcuts},null,8,["modelValue","onUpdate:modelValue","shortcuts"])):(w(),D(s,{key:3,onKeyup:a[1]||(a[1]=C((a=>e.queryData(1)),["enter"])),modelValue:e.queryParam[l.apiName],"onUpdate:modelValue":a=>e.queryParam[l.apiName]=a,placeholder:"请输入查询内容"},null,8,["modelValue","onUpdate:modelValue"]))])),_:2},1032,["label"])))),256)),_(p,null,{default:G((()=>[_(u,{type:"primary",onClick:a[2]||(a[2]=a=>e.queryData(1))},{default:G((()=>[U])),_:1})])),_:1})])),_:1})])),_:1}),_(h,{style:{border:"1px solid #eee",margin:"10px"}},{default:G((()=>[S(_(y,{size:"small",onSortChange:e.handleSortChange,onSelectionChange:e.handleSelectionChange,onRowDblclick:e.handleRowDbClick,data:e.dataGrid.result,height:480,border:""},{default:G((()=>[(w(!0),D(I,null,P(e.tableData.tableInfo.columns,(a=>(w(),D(I,null,["id"===a.apiName?(w(),D(b,{key:0,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,width:"60",prop:a.apiName,label:a.remark},null,8,["sortable","prop","label"])):"select"===a.view_type?(w(),D(b,{key:1,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark,width:"120"},{default:G((l=>[_(g,{size:"mini",style:{color:"white"},color:e.selectColor(l.row[a.apiName],a)},{default:G((()=>[V(q(e.selectLabel(l.row[a.apiName],a)),1)])),_:2},1032,["color"])])),_:2},1032,["sortable","prop","label"])):"object"===a.view_type?(w(),D(b,{key:2,sortable:"N"!==a.isSort,prop:a.apiName,label:a.remark},{default:G((l=>[_(f,{class:"el-icon-link",onClick:t=>e.openDialog(a.linkTableName,a.linkTable,l.row[a.apiName])},null,8,["onClick"]),_("span",null,q(l.row[a.apiName+"_desc"]),1)])),_:2},1032,["sortable","prop","label"])):(w(),D(b,{key:3,sortable:"N"!==a.isSort,"show-overflow-tooltip":!0,prop:a.apiName,label:a.remark},{default:G((e=>[V(q(e.row[a.apiName]),1)])),_:2},1032,["sortable","prop","label"]))],64)))),256))])),_:1},8,["onSortChange","onSelectionChange","onRowDblclick","data"]),[[E,e.dataGrid.loading]])])),_:1}),_(z,{onSizeChange:a[3]||(a[3]=a=>{e.dataGrid.pageSize=a,e.queryData(e.dataGrid.page)}),onCurrentChange:a[4]||(a[4]=a=>e.queryData(a)),currentPage:e.dataGrid.page,"onUpdate:currentPage":a[5]||(a[5]=a=>e.dataGrid.page=a),onPrevClick:a[6]||(a[6]=a=>e.queryData(e.dataGrid.page-1)),onNextClick:a[7]||(a[7]=a=>e.queryData(e.dataGrid.page+1)),"page-sizes":[10,30,50,100],"page-size":e.dataGrid.pageSize,layout:"sizes, prev, pager, next,total",total:e.dataGrid.total},null,8,["currentPage","page-size","total"])])),_:1},512)),[[E,e.tableData.loading]]),_(O,{"custom-class":e.fullScreen?"":"custom-el-dialog",width:"90%",fullscreen:e.fullScreen,"lock-scroll":"","append-to-body":"",modelValue:e.dialogVisible,"onUpdate:modelValue":a[9]||(a[9]=a=>e.dialogVisible=a),"destroy-on-close":""},{title:G((()=>[_(f,{class:"el-icon-reading"}),_("span",Y,q(e.openId.title),1),_(x,{style:{width:"100%"}}),_("i",{onClick:a[8]||(a[8]=a=>e.fullScreen=!e.fullScreen),class:"el-dialog__headerbtn2 el-icon-full-screen"})])),default:G((()=>[_(j,{"table-name":e.openId.tableName,id:e.openId.id},null,8,["table-name","id"])])),_:1},8,["custom-class","fullscreen","modelValue"])],64)}));O.render=E,O.__scopeId="data-v-5aa855f0";export default O;
